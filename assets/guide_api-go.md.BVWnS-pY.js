import{_ as a,c as i,o as n,a3 as t}from"./chunks/framework.BuRUkFgc.js";const c=JSON.parse('{"title":"Go Fiber åç«¯ API","description":"","frontmatter":{},"headers":[],"relativePath":"guide/api-go.md","filePath":"guide/api-go.md","lastUpdated":1765973614000}'),e={name:"guide/api-go.md"};function l(p,s,h,d,r,k){return n(),i("div",{"data-pagefind-body":!0,"data-pagefind-meta":"date:1765973614000"},[...s[0]||(s[0]=[t(`<h1 id="go-fiber-åç«¯-api" tabindex="-1">Go Fiber åç«¯ API <a class="header-anchor" href="#go-fiber-åç«¯-api" aria-label="Permalink to &quot;Go Fiber åç«¯ API&quot;">â€‹</a></h1><p>HaloLight Go Fiber åç«¯ API åŸºäº Fiber 3.0 æ„å»ºï¼Œæä¾›é«˜æ€§èƒ½ Go åç«¯æœåŠ¡å’Œå®Œæ•´çš„ JWT åŒä»¤ç‰Œè®¤è¯ã€‚</p><p><strong>API æ–‡æ¡£</strong>ï¼š<a href="https://halolight-api-go.h7ml.cn/docs" target="_blank" rel="noreferrer">https://halolight-api-go.h7ml.cn/docs</a></p><p><strong>GitHub</strong>ï¼š<a href="https://github.com/halolight/halolight-api-go" target="_blank" rel="noreferrer">https://github.com/halolight/halolight-api-go</a></p><h2 id="ç‰¹æ€§" tabindex="-1">ç‰¹æ€§ <a class="header-anchor" href="#ç‰¹æ€§" aria-label="Permalink to &quot;ç‰¹æ€§&quot;">â€‹</a></h2><ul><li>ğŸ” <strong>JWT åŒä»¤ç‰Œ</strong> - Access Token + Refresh Tokenï¼Œè‡ªåŠ¨ç»­æœŸ</li><li>ğŸ›¡ï¸ <strong>RBAC æƒé™</strong> - åŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶ï¼Œé€šé…ç¬¦åŒ¹é…</li><li>ğŸ“¡ <strong>RESTful API</strong> - æ ‡å‡†åŒ–æ¥å£è®¾è®¡ï¼ŒOpenAPI æ–‡æ¡£</li><li>ğŸ—„ï¸ <strong>GORM 2</strong> - ç±»å‹å®‰å…¨çš„æ•°æ®åº“æ“ä½œ</li><li>âœ… <strong>æ•°æ®éªŒè¯</strong> - è¯·æ±‚å‚æ•°æ ¡éªŒï¼Œé”™è¯¯å¤„ç†</li><li>ğŸ“Š <strong>æ—¥å¿—ç³»ç»Ÿ</strong> - è¯·æ±‚æ—¥å¿—ï¼Œé”™è¯¯è¿½è¸ª</li><li>ğŸ³ <strong>Docker æ”¯æŒ</strong> - å®¹å™¨åŒ–éƒ¨ç½²</li></ul><h2 id="æŠ€æœ¯æ ˆ" tabindex="-1">æŠ€æœ¯æ ˆ <a class="header-anchor" href="#æŠ€æœ¯æ ˆ" aria-label="Permalink to &quot;æŠ€æœ¯æ ˆ&quot;">â€‹</a></h2><table tabindex="0"><thead><tr><th>æŠ€æœ¯</th><th>ç‰ˆæœ¬</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>Go</td><td>1.22+</td><td>è¿è¡Œæ—¶</td></tr><tr><td>Fiber</td><td>3.0</td><td>Web æ¡†æ¶</td></tr><tr><td>GORM</td><td>2.0</td><td>æ•°æ®åº“ ORM</td></tr><tr><td>PostgreSQL</td><td>16</td><td>æ•°æ®å­˜å‚¨</td></tr><tr><td>go-playground/validator</td><td>v10</td><td>æ•°æ®éªŒè¯</td></tr><tr><td>JWT</td><td>golang-jwt/jwt/v5</td><td>èº«ä»½è®¤è¯</td></tr><tr><td>Swagger UI</td><td>-</td><td>API æ–‡æ¡£</td></tr></tbody></table><h2 id="å¿«é€Ÿå¼€å§‹" tabindex="-1">å¿«é€Ÿå¼€å§‹ <a class="header-anchor" href="#å¿«é€Ÿå¼€å§‹" aria-label="Permalink to &quot;å¿«é€Ÿå¼€å§‹&quot;">â€‹</a></h2><h3 id="ç¯å¢ƒè¦æ±‚" tabindex="-1">ç¯å¢ƒè¦æ±‚ <a class="header-anchor" href="#ç¯å¢ƒè¦æ±‚" aria-label="Permalink to &quot;ç¯å¢ƒè¦æ±‚&quot;">â€‹</a></h3><ul><li>Go &gt;= 1.22</li><li>PostgreSQL 16 (å¯é€‰ï¼Œé»˜è®¤ SQLite)</li></ul><h3 id="å®‰è£…" tabindex="-1">å®‰è£… <a class="header-anchor" href="#å®‰è£…" aria-label="Permalink to &quot;å®‰è£…&quot;">â€‹</a></h3><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å…‹éš†ä»“åº“</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> clone</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://github.com/halolight/halolight-api-go.git</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> halolight-api-go</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å®‰è£…ä¾èµ–</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">go</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mod</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> download</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="ç¯å¢ƒå˜é‡" tabindex="-1">ç¯å¢ƒå˜é‡ <a class="header-anchor" href="#ç¯å¢ƒå˜é‡" aria-label="Permalink to &quot;ç¯å¢ƒå˜é‡&quot;">â€‹</a></h3><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> .env.example</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> .env</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-env vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">env</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span># æ•°æ®åº“</span></span>
<span class="line"><span>DATABASE_URL=postgresql://user:pass@localhost:5432/halolight?sslmode=disable</span></span>
<span class="line"><span></span></span>
<span class="line"><span># JWT å¯†é’¥</span></span>
<span class="line"><span>JWT_SECRET=your-super-secret-key</span></span>
<span class="line"><span>JWT_ACCESS_EXPIRES=7d</span></span>
<span class="line"><span>JWT_REFRESH_EXPIRES=30d</span></span>
<span class="line"><span></span></span>
<span class="line"><span># æœåŠ¡é…ç½®</span></span>
<span class="line"><span>PORT=8080</span></span>
<span class="line"><span>APP_ENV=development</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h3 id="æ•°æ®åº“åˆå§‹åŒ–" tabindex="-1">æ•°æ®åº“åˆå§‹åŒ– <a class="header-anchor" href="#æ•°æ®åº“åˆå§‹åŒ–" aria-label="Permalink to &quot;æ•°æ®åº“åˆå§‹åŒ–&quot;">â€‹</a></h3><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># GORM è‡ªåŠ¨è¿ç§»</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">go</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cmd/server/main.go</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># æˆ–ä½¿ç”¨ Makefile</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">make</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> migrate</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="å¯åŠ¨æœåŠ¡" tabindex="-1">å¯åŠ¨æœåŠ¡ <a class="header-anchor" href="#å¯åŠ¨æœåŠ¡" aria-label="Permalink to &quot;å¯åŠ¨æœåŠ¡&quot;">â€‹</a></h3><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å¼€å‘æ¨¡å¼</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">go</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cmd/server/main.go</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ç”Ÿäº§æ¨¡å¼</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">make</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> build</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">./bin/server</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>è®¿é—® <a href="http://localhost:8080" target="_blank" rel="noreferrer">http://localhost:8080</a></p><h2 id="é¡¹ç›®ç»“æ„" tabindex="-1">é¡¹ç›®ç»“æ„ <a class="header-anchor" href="#é¡¹ç›®ç»“æ„" aria-label="Permalink to &quot;é¡¹ç›®ç»“æ„&quot;">â€‹</a></h2><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>halolight-api-go/</span></span>
<span class="line"><span>â”œâ”€â”€ cmd/</span></span>
<span class="line"><span>â”‚   â””â”€â”€ server/</span></span>
<span class="line"><span>â”‚       â””â”€â”€ main.go              # åº”ç”¨å…¥å£</span></span>
<span class="line"><span>â”œâ”€â”€ internal/</span></span>
<span class="line"><span>â”‚   â”œâ”€â”€ handlers/                # æ§åˆ¶å™¨/è·¯ç”±å¤„ç†</span></span>
<span class="line"><span>â”‚   â”‚   â”œâ”€â”€ auth_handler.go      # è®¤è¯ç«¯ç‚¹</span></span>
<span class="line"><span>â”‚   â”‚   â”œâ”€â”€ user_handler.go      # ç”¨æˆ·ç®¡ç†</span></span>
<span class="line"><span>â”‚   â”‚   â”œâ”€â”€ role_handler.go      # è§’è‰²ç®¡ç†</span></span>
<span class="line"><span>â”‚   â”‚   â”œâ”€â”€ permission_handler.go # æƒé™ç®¡ç†</span></span>
<span class="line"><span>â”‚   â”‚   â”œâ”€â”€ team_handler.go      # å›¢é˜Ÿç®¡ç†</span></span>
<span class="line"><span>â”‚   â”‚   â”œâ”€â”€ document_handler.go  # æ–‡æ¡£ç®¡ç†</span></span>
<span class="line"><span>â”‚   â”‚   â”œâ”€â”€ file_handler.go      # æ–‡ä»¶ç®¡ç†</span></span>
<span class="line"><span>â”‚   â”‚   â”œâ”€â”€ folder_handler.go    # æ–‡ä»¶å¤¹ç®¡ç†</span></span>
<span class="line"><span>â”‚   â”‚   â”œâ”€â”€ calendar_handler.go  # æ—¥å†äº‹ä»¶</span></span>
<span class="line"><span>â”‚   â”‚   â”œâ”€â”€ notification_handler.go # é€šçŸ¥ç®¡ç†</span></span>
<span class="line"><span>â”‚   â”‚   â”œâ”€â”€ message_handler.go   # æ¶ˆæ¯ç®¡ç†</span></span>
<span class="line"><span>â”‚   â”‚   â”œâ”€â”€ dashboard_handler.go # ä»ªè¡¨ç›˜ç»Ÿè®¡</span></span>
<span class="line"><span>â”‚   â”‚   â””â”€â”€ home_handler.go      # é¦–é¡µ + å¥åº·æ£€æŸ¥</span></span>
<span class="line"><span>â”‚   â”œâ”€â”€ services/                # ä¸šåŠ¡é€»è¾‘å±‚</span></span>
<span class="line"><span>â”‚   â”‚   â”œâ”€â”€ auth_service.go</span></span>
<span class="line"><span>â”‚   â”‚   â”œâ”€â”€ user_service.go</span></span>
<span class="line"><span>â”‚   â”‚   â””â”€â”€ ...</span></span>
<span class="line"><span>â”‚   â”œâ”€â”€ models/                  # æ•°æ®æ¨¡å‹</span></span>
<span class="line"><span>â”‚   â”‚   â”œâ”€â”€ user.go</span></span>
<span class="line"><span>â”‚   â”‚   â”œâ”€â”€ role.go</span></span>
<span class="line"><span>â”‚   â”‚   â””â”€â”€ ...</span></span>
<span class="line"><span>â”‚   â”œâ”€â”€ middleware/              # ä¸­é—´ä»¶</span></span>
<span class="line"><span>â”‚   â”‚   â”œâ”€â”€ auth.go</span></span>
<span class="line"><span>â”‚   â”‚   â””â”€â”€ cors.go</span></span>
<span class="line"><span>â”‚   â””â”€â”€ routes/                  # è·¯ç”±é…ç½®</span></span>
<span class="line"><span>â”‚       â””â”€â”€ router.go</span></span>
<span class="line"><span>â”œâ”€â”€ pkg/</span></span>
<span class="line"><span>â”‚   â”œâ”€â”€ config/                  # é…ç½®ç®¡ç†</span></span>
<span class="line"><span>â”‚   â”œâ”€â”€ database/                # æ•°æ®åº“è¿æ¥</span></span>
<span class="line"><span>â”‚   â””â”€â”€ utils/                   # å·¥å…·å‡½æ•°</span></span>
<span class="line"><span>â”œâ”€â”€ docs/                        # æ–‡æ¡£</span></span>
<span class="line"><span>â”œâ”€â”€ .github/workflows/           # GitHub Actions</span></span>
<span class="line"><span>â”œâ”€â”€ Dockerfile                   # Docker é…ç½®</span></span>
<span class="line"><span>â”œâ”€â”€ docker-compose.yml</span></span>
<span class="line"><span>â””â”€â”€ go.mod</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br></div></div><h2 id="api-æ¨¡å—" tabindex="-1">API æ¨¡å— <a class="header-anchor" href="#api-æ¨¡å—" aria-label="Permalink to &quot;API æ¨¡å—&quot;">â€‹</a></h2><h3 id="è®¤è¯ç›¸å…³ç«¯ç‚¹" tabindex="-1">è®¤è¯ç›¸å…³ç«¯ç‚¹ <a class="header-anchor" href="#è®¤è¯ç›¸å…³ç«¯ç‚¹" aria-label="Permalink to &quot;è®¤è¯ç›¸å…³ç«¯ç‚¹&quot;">â€‹</a></h3><table tabindex="0"><thead><tr><th>æ–¹æ³•</th><th>è·¯å¾„</th><th>æè¿°</th><th>æƒé™</th></tr></thead><tbody><tr><td>POST</td><td><code>/api/auth/login</code></td><td>ç”¨æˆ·ç™»å½•</td><td>å…¬å¼€</td></tr><tr><td>POST</td><td><code>/api/auth/register</code></td><td>ç”¨æˆ·æ³¨å†Œ</td><td>å…¬å¼€</td></tr><tr><td>POST</td><td><code>/api/auth/refresh</code></td><td>åˆ·æ–°ä»¤ç‰Œ</td><td>å…¬å¼€</td></tr><tr><td>POST</td><td><code>/api/auth/logout</code></td><td>é€€å‡ºç™»å½•</td><td>éœ€è®¤è¯</td></tr><tr><td>POST</td><td><code>/api/auth/forgot-password</code></td><td>å¿˜è®°å¯†ç </td><td>å…¬å¼€</td></tr><tr><td>POST</td><td><code>/api/auth/reset-password</code></td><td>é‡ç½®å¯†ç </td><td>å…¬å¼€</td></tr><tr><td>GET</td><td><code>/api/auth/me</code></td><td>è·å–å½“å‰ç”¨æˆ·</td><td>éœ€è®¤è¯</td></tr></tbody></table><h3 id="ç”¨æˆ·ç®¡ç†ç«¯ç‚¹" tabindex="-1">ç”¨æˆ·ç®¡ç†ç«¯ç‚¹ <a class="header-anchor" href="#ç”¨æˆ·ç®¡ç†ç«¯ç‚¹" aria-label="Permalink to &quot;ç”¨æˆ·ç®¡ç†ç«¯ç‚¹&quot;">â€‹</a></h3><table tabindex="0"><thead><tr><th>æ–¹æ³•</th><th>è·¯å¾„</th><th>æè¿°</th><th>æƒé™</th></tr></thead><tbody><tr><td>GET</td><td><code>/api/users</code></td><td>è·å–ç”¨æˆ·åˆ—è¡¨</td><td><code>users:view</code></td></tr><tr><td>GET</td><td><code>/api/users/:id</code></td><td>è·å–ç”¨æˆ·è¯¦æƒ…</td><td><code>users:view</code></td></tr><tr><td>POST</td><td><code>/api/users</code></td><td>åˆ›å»ºç”¨æˆ·</td><td><code>users:create</code></td></tr><tr><td>PUT</td><td><code>/api/users/:id</code></td><td>æ›´æ–°ç”¨æˆ·</td><td><code>users:update</code></td></tr><tr><td>DELETE</td><td><code>/api/users/:id</code></td><td>åˆ é™¤ç”¨æˆ·</td><td><code>users:delete</code></td></tr><tr><td>PATCH</td><td><code>/api/users/:id/status</code></td><td>æ›´æ–°ç”¨æˆ·çŠ¶æ€</td><td><code>users:update</code></td></tr><tr><td>POST</td><td><code>/api/users/batch-delete</code></td><td>æ‰¹é‡åˆ é™¤ç”¨æˆ·</td><td><code>users:delete</code></td></tr></tbody></table><h3 id="å®Œæ•´ç«¯ç‚¹æ¸…å•" tabindex="-1">å®Œæ•´ç«¯ç‚¹æ¸…å• <a class="header-anchor" href="#å®Œæ•´ç«¯ç‚¹æ¸…å•" aria-label="Permalink to &quot;å®Œæ•´ç«¯ç‚¹æ¸…å•&quot;">â€‹</a></h3><h4 id="è§’è‰²ç®¡ç†-roles-6-ä¸ªç«¯ç‚¹" tabindex="-1">è§’è‰²ç®¡ç† (Roles) - 6 ä¸ªç«¯ç‚¹ <a class="header-anchor" href="#è§’è‰²ç®¡ç†-roles-6-ä¸ªç«¯ç‚¹" aria-label="Permalink to &quot;è§’è‰²ç®¡ç† (Roles) - 6 ä¸ªç«¯ç‚¹&quot;">â€‹</a></h4><table tabindex="0"><thead><tr><th>æ–¹æ³•</th><th>è·¯å¾„</th><th>æè¿°</th></tr></thead><tbody><tr><td>GET</td><td><code>/api/roles</code></td><td>è·å–è§’è‰²åˆ—è¡¨</td></tr><tr><td>GET</td><td><code>/api/roles/:id</code></td><td>è·å–è§’è‰²è¯¦æƒ…</td></tr><tr><td>POST</td><td><code>/api/roles</code></td><td>åˆ›å»ºè§’è‰²</td></tr><tr><td>PUT</td><td><code>/api/roles/:id</code></td><td>æ›´æ–°è§’è‰²</td></tr><tr><td>POST</td><td><code>/api/roles/:id/permissions</code></td><td>åˆ†é…æƒé™</td></tr><tr><td>DELETE</td><td><code>/api/roles/:id</code></td><td>åˆ é™¤è§’è‰²</td></tr></tbody></table><h4 id="æƒé™ç®¡ç†-permissions-4-ä¸ªç«¯ç‚¹" tabindex="-1">æƒé™ç®¡ç† (Permissions) - 4 ä¸ªç«¯ç‚¹ <a class="header-anchor" href="#æƒé™ç®¡ç†-permissions-4-ä¸ªç«¯ç‚¹" aria-label="Permalink to &quot;æƒé™ç®¡ç† (Permissions) - 4 ä¸ªç«¯ç‚¹&quot;">â€‹</a></h4><table tabindex="0"><thead><tr><th>æ–¹æ³•</th><th>è·¯å¾„</th><th>æè¿°</th></tr></thead><tbody><tr><td>GET</td><td><code>/api/permissions</code></td><td>è·å–æƒé™åˆ—è¡¨</td></tr><tr><td>GET</td><td><code>/api/permissions/:id</code></td><td>è·å–æƒé™è¯¦æƒ…</td></tr><tr><td>POST</td><td><code>/api/permissions</code></td><td>åˆ›å»ºæƒé™</td></tr><tr><td>DELETE</td><td><code>/api/permissions/:id</code></td><td>åˆ é™¤æƒé™</td></tr></tbody></table><h4 id="å›¢é˜Ÿç®¡ç†-teams-7-ä¸ªç«¯ç‚¹" tabindex="-1">å›¢é˜Ÿç®¡ç† (Teams) - 7 ä¸ªç«¯ç‚¹ <a class="header-anchor" href="#å›¢é˜Ÿç®¡ç†-teams-7-ä¸ªç«¯ç‚¹" aria-label="Permalink to &quot;å›¢é˜Ÿç®¡ç† (Teams) - 7 ä¸ªç«¯ç‚¹&quot;">â€‹</a></h4><table tabindex="0"><thead><tr><th>æ–¹æ³•</th><th>è·¯å¾„</th><th>æè¿°</th></tr></thead><tbody><tr><td>GET</td><td><code>/api/teams</code></td><td>è·å–å›¢é˜Ÿåˆ—è¡¨</td></tr><tr><td>GET</td><td><code>/api/teams/:id</code></td><td>è·å–å›¢é˜Ÿè¯¦æƒ…</td></tr><tr><td>POST</td><td><code>/api/teams</code></td><td>åˆ›å»ºå›¢é˜Ÿ</td></tr><tr><td>PATCH</td><td><code>/api/teams/:id</code></td><td>æ›´æ–°å›¢é˜Ÿ</td></tr><tr><td>DELETE</td><td><code>/api/teams/:id</code></td><td>åˆ é™¤å›¢é˜Ÿ</td></tr><tr><td>POST</td><td><code>/api/teams/:id/members</code></td><td>æ·»åŠ æˆå‘˜</td></tr><tr><td>DELETE</td><td><code>/api/teams/:id/members/:userId</code></td><td>ç§»é™¤æˆå‘˜</td></tr></tbody></table><h4 id="æ–‡æ¡£ç®¡ç†-documents-11-ä¸ªç«¯ç‚¹" tabindex="-1">æ–‡æ¡£ç®¡ç† (Documents) - 11 ä¸ªç«¯ç‚¹ <a class="header-anchor" href="#æ–‡æ¡£ç®¡ç†-documents-11-ä¸ªç«¯ç‚¹" aria-label="Permalink to &quot;æ–‡æ¡£ç®¡ç† (Documents) - 11 ä¸ªç«¯ç‚¹&quot;">â€‹</a></h4><table tabindex="0"><thead><tr><th>æ–¹æ³•</th><th>è·¯å¾„</th><th>æè¿°</th></tr></thead><tbody><tr><td>GET</td><td><code>/api/documents</code></td><td>è·å–æ–‡æ¡£åˆ—è¡¨</td></tr><tr><td>GET</td><td><code>/api/documents/:id</code></td><td>è·å–æ–‡æ¡£è¯¦æƒ…</td></tr><tr><td>POST</td><td><code>/api/documents</code></td><td>åˆ›å»ºæ–‡æ¡£</td></tr><tr><td>PUT</td><td><code>/api/documents/:id</code></td><td>æ›´æ–°æ–‡æ¡£</td></tr><tr><td>PATCH</td><td><code>/api/documents/:id/rename</code></td><td>é‡å‘½åæ–‡æ¡£</td></tr><tr><td>POST</td><td><code>/api/documents/:id/move</code></td><td>ç§»åŠ¨æ–‡æ¡£</td></tr><tr><td>POST</td><td><code>/api/documents/:id/tags</code></td><td>æ›´æ–°æ ‡ç­¾</td></tr><tr><td>POST</td><td><code>/api/documents/:id/share</code></td><td>åˆ†äº«æ–‡æ¡£</td></tr><tr><td>POST</td><td><code>/api/documents/:id/unshare</code></td><td>å–æ¶ˆåˆ†äº«</td></tr><tr><td>POST</td><td><code>/api/documents/batch-delete</code></td><td>æ‰¹é‡åˆ é™¤</td></tr><tr><td>DELETE</td><td><code>/api/documents/:id</code></td><td>åˆ é™¤æ–‡æ¡£</td></tr></tbody></table><h4 id="æ–‡ä»¶ç®¡ç†-files-14-ä¸ªç«¯ç‚¹" tabindex="-1">æ–‡ä»¶ç®¡ç† (Files) - 14 ä¸ªç«¯ç‚¹ <a class="header-anchor" href="#æ–‡ä»¶ç®¡ç†-files-14-ä¸ªç«¯ç‚¹" aria-label="Permalink to &quot;æ–‡ä»¶ç®¡ç† (Files) - 14 ä¸ªç«¯ç‚¹&quot;">â€‹</a></h4><table tabindex="0"><thead><tr><th>æ–¹æ³•</th><th>è·¯å¾„</th><th>æè¿°</th></tr></thead><tbody><tr><td>POST</td><td><code>/api/files/upload</code></td><td>ä¸Šä¼ æ–‡ä»¶</td></tr><tr><td>POST</td><td><code>/api/files/folder</code></td><td>åˆ›å»ºæ–‡ä»¶å¤¹</td></tr><tr><td>GET</td><td><code>/api/files</code></td><td>è·å–æ–‡ä»¶åˆ—è¡¨</td></tr><tr><td>GET</td><td><code>/api/files/storage</code></td><td>è·å–å­˜å‚¨ä¿¡æ¯</td></tr><tr><td>GET</td><td><code>/api/files/:id</code></td><td>è·å–æ–‡ä»¶è¯¦æƒ…</td></tr><tr><td>GET</td><td><code>/api/files/:id/download-url</code></td><td>è·å–ä¸‹è½½é“¾æ¥</td></tr><tr><td>PATCH</td><td><code>/api/files/:id/rename</code></td><td>é‡å‘½åæ–‡ä»¶</td></tr><tr><td>POST</td><td><code>/api/files/:id/move</code></td><td>ç§»åŠ¨æ–‡ä»¶</td></tr><tr><td>POST</td><td><code>/api/files/:id/copy</code></td><td>å¤åˆ¶æ–‡ä»¶</td></tr><tr><td>PATCH</td><td><code>/api/files/:id/favorite</code></td><td>æ”¶è—/å–æ¶ˆæ”¶è—</td></tr><tr><td>POST</td><td><code>/api/files/:id/share</code></td><td>åˆ†äº«æ–‡ä»¶</td></tr><tr><td>POST</td><td><code>/api/files/batch-delete</code></td><td>æ‰¹é‡åˆ é™¤</td></tr><tr><td>DELETE</td><td><code>/api/files/:id</code></td><td>åˆ é™¤æ–‡ä»¶</td></tr></tbody></table><h4 id="æ–‡ä»¶å¤¹ç®¡ç†-folders-5-ä¸ªç«¯ç‚¹" tabindex="-1">æ–‡ä»¶å¤¹ç®¡ç† (Folders) - 5 ä¸ªç«¯ç‚¹ <a class="header-anchor" href="#æ–‡ä»¶å¤¹ç®¡ç†-folders-5-ä¸ªç«¯ç‚¹" aria-label="Permalink to &quot;æ–‡ä»¶å¤¹ç®¡ç† (Folders) - 5 ä¸ªç«¯ç‚¹&quot;">â€‹</a></h4><table tabindex="0"><thead><tr><th>æ–¹æ³•</th><th>è·¯å¾„</th><th>æè¿°</th></tr></thead><tbody><tr><td>GET</td><td><code>/api/folders</code></td><td>è·å–æ–‡ä»¶å¤¹åˆ—è¡¨</td></tr><tr><td>GET</td><td><code>/api/folders/tree</code></td><td>è·å–æ ‘å½¢ç»“æ„</td></tr><tr><td>GET</td><td><code>/api/folders/:id</code></td><td>è·å–æ–‡ä»¶å¤¹è¯¦æƒ…</td></tr><tr><td>POST</td><td><code>/api/folders</code></td><td>åˆ›å»ºæ–‡ä»¶å¤¹</td></tr><tr><td>DELETE</td><td><code>/api/folders/:id</code></td><td>åˆ é™¤æ–‡ä»¶å¤¹</td></tr></tbody></table><h4 id="æ¶ˆæ¯ç®¡ç†-messages-5-ä¸ªç«¯ç‚¹" tabindex="-1">æ¶ˆæ¯ç®¡ç† (Messages) - 5 ä¸ªç«¯ç‚¹ <a class="header-anchor" href="#æ¶ˆæ¯ç®¡ç†-messages-5-ä¸ªç«¯ç‚¹" aria-label="Permalink to &quot;æ¶ˆæ¯ç®¡ç† (Messages) - 5 ä¸ªç«¯ç‚¹&quot;">â€‹</a></h4><table tabindex="0"><thead><tr><th>æ–¹æ³•</th><th>è·¯å¾„</th><th>æè¿°</th></tr></thead><tbody><tr><td>GET</td><td><code>/api/messages/conversations</code></td><td>è·å–ä¼šè¯åˆ—è¡¨</td></tr><tr><td>GET</td><td><code>/api/messages/conversations/:id</code></td><td>è·å–ä¼šè¯è¯¦æƒ…</td></tr><tr><td>POST</td><td><code>/api/messages</code></td><td>å‘é€æ¶ˆæ¯</td></tr><tr><td>PUT</td><td><code>/api/messages/:id/read</code></td><td>æ ‡è®°å·²è¯»</td></tr><tr><td>DELETE</td><td><code>/api/messages/:id</code></td><td>åˆ é™¤æ¶ˆæ¯</td></tr></tbody></table><h4 id="é€šçŸ¥ç®¡ç†-notifications-5-ä¸ªç«¯ç‚¹" tabindex="-1">é€šçŸ¥ç®¡ç† (Notifications) - 5 ä¸ªç«¯ç‚¹ <a class="header-anchor" href="#é€šçŸ¥ç®¡ç†-notifications-5-ä¸ªç«¯ç‚¹" aria-label="Permalink to &quot;é€šçŸ¥ç®¡ç† (Notifications) - 5 ä¸ªç«¯ç‚¹&quot;">â€‹</a></h4><table tabindex="0"><thead><tr><th>æ–¹æ³•</th><th>è·¯å¾„</th><th>æè¿°</th></tr></thead><tbody><tr><td>GET</td><td><code>/api/notifications</code></td><td>è·å–é€šçŸ¥åˆ—è¡¨</td></tr><tr><td>GET</td><td><code>/api/notifications/unread-count</code></td><td>è·å–æœªè¯»æ•°é‡</td></tr><tr><td>PUT</td><td><code>/api/notifications/:id/read</code></td><td>æ ‡è®°å·²è¯»</td></tr><tr><td>PUT</td><td><code>/api/notifications/read-all</code></td><td>å…¨éƒ¨å·²è¯»</td></tr><tr><td>DELETE</td><td><code>/api/notifications/:id</code></td><td>åˆ é™¤é€šçŸ¥</td></tr></tbody></table><h4 id="æ—¥å†ç®¡ç†-calendar-9-ä¸ªç«¯ç‚¹" tabindex="-1">æ—¥å†ç®¡ç† (Calendar) - 9 ä¸ªç«¯ç‚¹ <a class="header-anchor" href="#æ—¥å†ç®¡ç†-calendar-9-ä¸ªç«¯ç‚¹" aria-label="Permalink to &quot;æ—¥å†ç®¡ç† (Calendar) - 9 ä¸ªç«¯ç‚¹&quot;">â€‹</a></h4><table tabindex="0"><thead><tr><th>æ–¹æ³•</th><th>è·¯å¾„</th><th>æè¿°</th></tr></thead><tbody><tr><td>GET</td><td><code>/api/calendar/events</code></td><td>è·å–æ—¥ç¨‹åˆ—è¡¨</td></tr><tr><td>GET</td><td><code>/api/calendar/events/:id</code></td><td>è·å–æ—¥ç¨‹è¯¦æƒ…</td></tr><tr><td>POST</td><td><code>/api/calendar/events</code></td><td>åˆ›å»ºæ—¥ç¨‹</td></tr><tr><td>PUT</td><td><code>/api/calendar/events/:id</code></td><td>æ›´æ–°æ—¥ç¨‹</td></tr><tr><td>PATCH</td><td><code>/api/calendar/events/:id/reschedule</code></td><td>é‡æ–°å®‰æ’</td></tr><tr><td>POST</td><td><code>/api/calendar/events/:id/attendees</code></td><td>æ·»åŠ å‚ä¼šäºº</td></tr><tr><td>DELETE</td><td><code>/api/calendar/events/:id/attendees/:attendeeId</code></td><td>ç§»é™¤å‚ä¼šäºº</td></tr><tr><td>POST</td><td><code>/api/calendar/events/batch-delete</code></td><td>æ‰¹é‡åˆ é™¤</td></tr><tr><td>DELETE</td><td><code>/api/calendar/events/:id</code></td><td>åˆ é™¤æ—¥ç¨‹</td></tr></tbody></table><h4 id="ä»ªè¡¨ç›˜-dashboard-9-ä¸ªç«¯ç‚¹" tabindex="-1">ä»ªè¡¨ç›˜ (Dashboard) - 9 ä¸ªç«¯ç‚¹ <a class="header-anchor" href="#ä»ªè¡¨ç›˜-dashboard-9-ä¸ªç«¯ç‚¹" aria-label="Permalink to &quot;ä»ªè¡¨ç›˜ (Dashboard) - 9 ä¸ªç«¯ç‚¹&quot;">â€‹</a></h4><table tabindex="0"><thead><tr><th>æ–¹æ³•</th><th>è·¯å¾„</th><th>æè¿°</th></tr></thead><tbody><tr><td>GET</td><td><code>/api/dashboard/stats</code></td><td>ç»Ÿè®¡æ•°æ®</td></tr><tr><td>GET</td><td><code>/api/dashboard/visits</code></td><td>è®¿é—®è¶‹åŠ¿</td></tr><tr><td>GET</td><td><code>/api/dashboard/sales</code></td><td>é”€å”®æ•°æ®</td></tr><tr><td>GET</td><td><code>/api/dashboard/products</code></td><td>äº§å“æ•°æ®</td></tr><tr><td>GET</td><td><code>/api/dashboard/orders</code></td><td>è®¢å•æ•°æ®</td></tr><tr><td>GET</td><td><code>/api/dashboard/activities</code></td><td>æ´»åŠ¨æ•°æ®</td></tr><tr><td>GET</td><td><code>/api/dashboard/pie</code></td><td>é¥¼å›¾æ•°æ®</td></tr><tr><td>GET</td><td><code>/api/dashboard/tasks</code></td><td>å¾…åŠä»»åŠ¡</td></tr><tr><td>GET</td><td><code>/api/dashboard/overview</code></td><td>æ€»è§ˆæ•°æ®</td></tr></tbody></table><h2 id="è®¤è¯æœºåˆ¶" tabindex="-1">è®¤è¯æœºåˆ¶ <a class="header-anchor" href="#è®¤è¯æœºåˆ¶" aria-label="Permalink to &quot;è®¤è¯æœºåˆ¶&quot;">â€‹</a></h2><h3 id="jwt-åŒä»¤ç‰Œ" tabindex="-1">JWT åŒä»¤ç‰Œ <a class="header-anchor" href="#jwt-åŒä»¤ç‰Œ" aria-label="Permalink to &quot;JWT åŒä»¤ç‰Œ&quot;">â€‹</a></h3><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Access Token:  7 å¤©æœ‰æ•ˆæœŸï¼Œç”¨äº API è¯·æ±‚</span></span>
<span class="line"><span>Refresh Token: 30 å¤©æœ‰æ•ˆæœŸï¼Œç”¨äºåˆ·æ–° Access Token</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="è¯·æ±‚å¤´" tabindex="-1">è¯·æ±‚å¤´ <a class="header-anchor" href="#è¯·æ±‚å¤´" aria-label="Permalink to &quot;è¯·æ±‚å¤´&quot;">â€‹</a></h3><div class="language-http vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">http</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Authorization</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Bearer &lt;access_token&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="åˆ·æ–°æµç¨‹" tabindex="-1">åˆ·æ–°æµç¨‹ <a class="header-anchor" href="#åˆ·æ–°æµç¨‹" aria-label="Permalink to &quot;åˆ·æ–°æµç¨‹&quot;">â€‹</a></h3><div class="language-go vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// åˆ·æ–°ä»¤ç‰Œç¤ºä¾‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">func</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> RefreshToken</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">c</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">fiber</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Ctx</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    type</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> RefreshRequest</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        RefreshToken </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">string</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> \`json:&quot;refreshToken&quot;\`</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    var</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> req </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">RefreshRequest</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> err </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> c.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">BodyParser</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">req); err </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> nil</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> c.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Status</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">400</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">JSON</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">fiber</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Map</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            &quot;success&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            &quot;message&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Invalid request&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // éªŒè¯ refresh token</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    claims, err </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> utils.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ValidateToken</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(req.RefreshToken)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> err </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> nil</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> c.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Status</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">401</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">JSON</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">fiber</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Map</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            &quot;success&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            &quot;message&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Invalid refresh token&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // ç”Ÿæˆæ–°çš„ access token</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    accessToken, err </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> utils.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">GenerateAccessToken</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(claims.UserID)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> err </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> nil</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> c.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Status</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">500</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">JSON</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">fiber</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Map</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            &quot;success&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            &quot;message&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Failed to generate token&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> c.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">JSON</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">fiber</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Map</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;success&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;accessToken&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: accessToken,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br></div></div><h2 id="æƒé™ç³»ç»Ÿ" tabindex="-1">æƒé™ç³»ç»Ÿ <a class="header-anchor" href="#æƒé™ç³»ç»Ÿ" aria-label="Permalink to &quot;æƒé™ç³»ç»Ÿ&quot;">â€‹</a></h2><h3 id="è§’è‰²å®šä¹‰" tabindex="-1">è§’è‰²å®šä¹‰ <a class="header-anchor" href="#è§’è‰²å®šä¹‰" aria-label="Permalink to &quot;è§’è‰²å®šä¹‰&quot;">â€‹</a></h3><table tabindex="0"><thead><tr><th>è§’è‰²</th><th>è¯´æ˜</th><th>æƒé™</th></tr></thead><tbody><tr><td><code>super_admin</code></td><td>è¶…çº§ç®¡ç†å‘˜</td><td><code>*</code> (æ‰€æœ‰æƒé™)</td></tr><tr><td><code>admin</code></td><td>ç®¡ç†å‘˜</td><td><code>users:*</code>, <code>documents:*</code>, <code>files:*</code>, <code>teams:*</code></td></tr><tr><td><code>user</code></td><td>æ™®é€šç”¨æˆ·</td><td><code>documents:view</code>, <code>documents:create</code>, <code>files:*</code></td></tr><tr><td><code>guest</code></td><td>è®¿å®¢</td><td><code>dashboard:view</code></td></tr></tbody></table><h3 id="æƒé™æ ¼å¼" tabindex="-1">æƒé™æ ¼å¼ <a class="header-anchor" href="#æƒé™æ ¼å¼" aria-label="Permalink to &quot;æƒé™æ ¼å¼&quot;">â€‹</a></h3><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>{resource}:{action}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>ç¤ºä¾‹ï¼š</span></span>
<span class="line"><span>- users:view      # æŸ¥çœ‹ç”¨æˆ·</span></span>
<span class="line"><span>- users:create    # åˆ›å»ºç”¨æˆ·</span></span>
<span class="line"><span>- users:*         # ç”¨æˆ·æ‰€æœ‰æ“ä½œ</span></span>
<span class="line"><span>- *               # æ‰€æœ‰æƒé™</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h2 id="é”™è¯¯å¤„ç†" tabindex="-1">é”™è¯¯å¤„ç† <a class="header-anchor" href="#é”™è¯¯å¤„ç†" aria-label="Permalink to &quot;é”™è¯¯å¤„ç†&quot;">â€‹</a></h2><h3 id="é”™è¯¯å“åº”æ ¼å¼" tabindex="-1">é”™è¯¯å“åº”æ ¼å¼ <a class="header-anchor" href="#é”™è¯¯å“åº”æ ¼å¼" aria-label="Permalink to &quot;é”™è¯¯å“åº”æ ¼å¼&quot;">â€‹</a></h3><div class="language-json vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;success&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;error&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;code&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;VALIDATION_ERROR&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;message&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;è¯·æ±‚å‚æ•°éªŒè¯å¤±è´¥&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;details&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      { </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">&quot;field&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;email&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">&quot;message&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;é‚®ç®±æ ¼å¼ä¸æ­£ç¡®&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h3 id="é”™è¯¯ç " tabindex="-1">é”™è¯¯ç  <a class="header-anchor" href="#é”™è¯¯ç " aria-label="Permalink to &quot;é”™è¯¯ç &quot;">â€‹</a></h3><table tabindex="0"><thead><tr><th>çŠ¶æ€ç </th><th>é”™è¯¯ç </th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>400</td><td><code>VALIDATION_ERROR</code></td><td>å‚æ•°éªŒè¯å¤±è´¥</td></tr><tr><td>401</td><td><code>UNAUTHORIZED</code></td><td>æœªæˆæƒ</td></tr><tr><td>403</td><td><code>FORBIDDEN</code></td><td>æ— æƒé™</td></tr><tr><td>404</td><td><code>NOT_FOUND</code></td><td>èµ„æºä¸å­˜åœ¨</td></tr><tr><td>409</td><td><code>CONFLICT</code></td><td>èµ„æºå†²çª</td></tr><tr><td>500</td><td><code>INTERNAL_ERROR</code></td><td>æœåŠ¡å™¨é”™è¯¯</td></tr></tbody></table><h2 id="å¸¸ç”¨å‘½ä»¤" tabindex="-1">å¸¸ç”¨å‘½ä»¤ <a class="header-anchor" href="#å¸¸ç”¨å‘½ä»¤" aria-label="Permalink to &quot;å¸¸ç”¨å‘½ä»¤&quot;">â€‹</a></h2><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å¼€å‘</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">go</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cmd/server/main.go</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># æ„å»º</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">go</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> build</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -o</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> bin/server</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cmd/server/main.go</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># æµ‹è¯•</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">go</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> test</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ./...</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># æ•°æ®åº“</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">make</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> migrate</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ä»£ç è´¨é‡</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">go</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> vet</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ./...</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">golangci-lint</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h2 id="éƒ¨ç½²" tabindex="-1">éƒ¨ç½² <a class="header-anchor" href="#éƒ¨ç½²" aria-label="Permalink to &quot;éƒ¨ç½²&quot;">â€‹</a></h2><h3 id="docker" tabindex="-1">Docker <a class="header-anchor" href="#docker" aria-label="Permalink to &quot;Docker&quot;">â€‹</a></h3><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> build</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -t</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> halolight-api-go</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> .</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 8080:8080</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> halolight-api-go</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="docker-compose" tabindex="-1">Docker Compose <a class="header-anchor" href="#docker-compose" aria-label="Permalink to &quot;Docker Compose&quot;">â€‹</a></h3><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker-compose</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> up</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -d</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-yaml vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># docker-compose.yml</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">version</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;3.8&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">services</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  app</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    build</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">.</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    ports</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;8080:8080&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    environment</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">APP_ENV=production</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">DATABASE_URL=\${DATABASE_URL}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">JWT_SECRET=\${JWT_SECRET}</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    restart</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">unless-stopped</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  db</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    image</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">postgres:16-alpine</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    environment</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      POSTGRES_DB</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">halolight</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      POSTGRES_USER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">\${DB_USER}</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      POSTGRES_PASSWORD</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">\${DB_PASSWORD}</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    volumes</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">postgres_data:/var/lib/postgresql/data</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">volumes</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  postgres_data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><h3 id="ç”Ÿäº§ç¯å¢ƒé…ç½®" tabindex="-1">ç”Ÿäº§ç¯å¢ƒé…ç½® <a class="header-anchor" href="#ç”Ÿäº§ç¯å¢ƒé…ç½®" aria-label="Permalink to &quot;ç”Ÿäº§ç¯å¢ƒé…ç½®&quot;">â€‹</a></h3><div class="language-env vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">env</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>APP_ENV=production</span></span>
<span class="line"><span>DATABASE_URL=postgresql://user:pass@host:5432/db</span></span>
<span class="line"><span>JWT_SECRET=your-production-secret</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="æµ‹è¯•" tabindex="-1">æµ‹è¯• <a class="header-anchor" href="#æµ‹è¯•" aria-label="Permalink to &quot;æµ‹è¯•&quot;">â€‹</a></h2><h3 id="è¿è¡Œæµ‹è¯•" tabindex="-1">è¿è¡Œæµ‹è¯• <a class="header-anchor" href="#è¿è¡Œæµ‹è¯•" aria-label="Permalink to &quot;è¿è¡Œæµ‹è¯•&quot;">â€‹</a></h3><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å•å…ƒæµ‹è¯•</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">go</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> test</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ./...</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># æµ‹è¯•è¦†ç›–ç‡</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">go</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> test</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -coverprofile=coverage.out</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ./...</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">go</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tool</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cover</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -html=coverage.out</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="æµ‹è¯•ç¤ºä¾‹" tabindex="-1">æµ‹è¯•ç¤ºä¾‹ <a class="header-anchor" href="#æµ‹è¯•ç¤ºä¾‹" aria-label="Permalink to &quot;æµ‹è¯•ç¤ºä¾‹&quot;">â€‹</a></h3><div class="language-go vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">func</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> TestUserLogin</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">t</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">testing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">T</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    app </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> fiber.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">New</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // è®¾ç½®è·¯ç”±</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    app.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Post</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/api/auth/login&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, handlers.Login)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // å‡†å¤‡æµ‹è¯•æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    reqBody </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> \`{&quot;email&quot;:&quot;test@example.com&quot;,&quot;password&quot;:&quot;password123&quot;}\`</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    req </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> httptest.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">NewRequest</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;POST&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/api/auth/login&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, strings.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">NewReader</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(reqBody))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    req.Header.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Content-Type&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;application/json&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // æ‰§è¡Œè¯·æ±‚</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    resp, _ </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> app.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Test</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(req)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // éªŒè¯å“åº”</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    assert.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Equal</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(t, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">200</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, resp.StatusCode)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h2 id="æ€§èƒ½æŒ‡æ ‡" tabindex="-1">æ€§èƒ½æŒ‡æ ‡ <a class="header-anchor" href="#æ€§èƒ½æŒ‡æ ‡" aria-label="Permalink to &quot;æ€§èƒ½æŒ‡æ ‡&quot;">â€‹</a></h2><h3 id="åŸºå‡†æµ‹è¯•" tabindex="-1">åŸºå‡†æµ‹è¯• <a class="header-anchor" href="#åŸºå‡†æµ‹è¯•" aria-label="Permalink to &quot;åŸºå‡†æµ‹è¯•&quot;">â€‹</a></h3><table tabindex="0"><thead><tr><th>æŒ‡æ ‡</th><th>æ•°å€¼</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>è¯·æ±‚ååé‡</td><td>10,000+ QPS</td><td>å•æœºï¼Œ8 æ ¸ CPU</td></tr><tr><td>å¹³å‡å“åº”æ—¶é—´</td><td>&lt; 10ms</td><td>ç®€å•æŸ¥è¯¢</td></tr><tr><td>å†…å­˜å ç”¨</td><td>~50MB</td><td>ç©ºé—²çŠ¶æ€</td></tr><tr><td>CPU ä½¿ç”¨ç‡</td><td>&lt; 10%</td><td>ç©ºé—²çŠ¶æ€</td></tr></tbody></table><h2 id="å¯è§‚æµ‹æ€§" tabindex="-1">å¯è§‚æµ‹æ€§ <a class="header-anchor" href="#å¯è§‚æµ‹æ€§" aria-label="Permalink to &quot;å¯è§‚æµ‹æ€§&quot;">â€‹</a></h2><h3 id="æ—¥å¿—ç³»ç»Ÿ" tabindex="-1">æ—¥å¿—ç³»ç»Ÿ <a class="header-anchor" href="#æ—¥å¿—ç³»ç»Ÿ" aria-label="Permalink to &quot;æ—¥å¿—ç³»ç»Ÿ&quot;">â€‹</a></h3><div class="language-go vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// æ—¥å¿—é…ç½®</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">logger </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> log.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">New</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(os.Stdout, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;API: &quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, log.LstdFlags)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">app.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Use</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">func</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">c</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">fiber</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Ctx</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    start </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> time.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Now</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    err </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> c.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Next</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    logger.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Printf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">%s</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> %s</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> %s</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> %v</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        c.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Method</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        c.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Path</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        c.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">IP</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        time.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Since</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(start),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    )</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> err</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h3 id="å¥åº·æ£€æŸ¥" tabindex="-1">å¥åº·æ£€æŸ¥ <a class="header-anchor" href="#å¥åº·æ£€æŸ¥" aria-label="Permalink to &quot;å¥åº·æ£€æŸ¥&quot;">â€‹</a></h3><div class="language-go vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// å¥åº·æ£€æŸ¥ç«¯ç‚¹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">app.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Get</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/health&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">func</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">c</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">fiber</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Ctx</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> c.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">JSON</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">fiber</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Map</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;status&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;healthy&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;timestamp&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: time.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Now</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(),</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;database&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: db.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Ping</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> nil</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="ç›‘æ§æŒ‡æ ‡" tabindex="-1">ç›‘æ§æŒ‡æ ‡ <a class="header-anchor" href="#ç›‘æ§æŒ‡æ ‡" aria-label="Permalink to &quot;ç›‘æ§æŒ‡æ ‡&quot;">â€‹</a></h3><div class="language-go vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Prometheus æŒ‡æ ‡</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">github.com/prometheus/client_golang/prometheus</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">var</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    requestCounter </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> prometheus.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">NewCounterVec</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        prometheus</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">CounterOpts</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            Name: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;api_requests_total&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            Help: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Total API requests&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        []</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;method&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;path&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;status&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">},</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    )</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h2 id="å¸¸è§é—®é¢˜" tabindex="-1">å¸¸è§é—®é¢˜ <a class="header-anchor" href="#å¸¸è§é—®é¢˜" aria-label="Permalink to &quot;å¸¸è§é—®é¢˜&quot;">â€‹</a></h2><h3 id="q-jwt-å¯†é’¥é•¿åº¦è¦æ±‚" tabindex="-1">Qï¼šJWT å¯†é’¥é•¿åº¦è¦æ±‚ï¼Ÿ <a class="header-anchor" href="#q-jwt-å¯†é’¥é•¿åº¦è¦æ±‚" aria-label="Permalink to &quot;Qï¼šJWT å¯†é’¥é•¿åº¦è¦æ±‚ï¼Ÿ&quot;">â€‹</a></h3><p>Aï¼šJWT å¯†é’¥è‡³å°‘ 32 å­—ç¬¦ï¼Œå»ºè®®ä½¿ç”¨ 64 å­—ç¬¦ä»¥ä¸Šçš„éšæœºå­—ç¬¦ä¸²ã€‚</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ç”Ÿæˆå®‰å…¨å¯†é’¥</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openssl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> rand</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -base64</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 64</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="q-æ•°æ®åº“è¿æ¥å¤±è´¥" tabindex="-1">Qï¼šæ•°æ®åº“è¿æ¥å¤±è´¥ï¼Ÿ <a class="header-anchor" href="#q-æ•°æ®åº“è¿æ¥å¤±è´¥" aria-label="Permalink to &quot;Qï¼šæ•°æ®åº“è¿æ¥å¤±è´¥ï¼Ÿ&quot;">â€‹</a></h3><p>Aï¼šæ£€æŸ¥æ•°æ®åº“é…ç½®å’Œç½‘ç»œè¿æ¥ã€‚</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># æ£€æŸ¥ PostgreSQL çŠ¶æ€</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker-compose</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ps</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> postgres</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># æµ‹è¯•è¿æ¥</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">psql</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -h</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> localhost</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -U</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> postgres</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> halolight</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="å¼€å‘å·¥å…·" tabindex="-1">å¼€å‘å·¥å…· <a class="header-anchor" href="#å¼€å‘å·¥å…·" aria-label="Permalink to &quot;å¼€å‘å·¥å…·&quot;">â€‹</a></h2><h3 id="æ¨èæ’ä»¶-å·¥å…·" tabindex="-1">æ¨èæ’ä»¶/å·¥å…· <a class="header-anchor" href="#æ¨èæ’ä»¶-å·¥å…·" aria-label="Permalink to &quot;æ¨èæ’ä»¶/å·¥å…·&quot;">â€‹</a></h3><ul><li><strong>Air</strong> - Go çƒ­é‡è½½å·¥å…·</li><li><strong>golangci-lint</strong> - Go ä»£ç æ£€æŸ¥</li><li><strong>goose</strong> - æ•°æ®åº“è¿ç§»å·¥å…·</li><li><strong>mockery</strong> - Mock ç”Ÿæˆå·¥å…·</li></ul><h2 id="ä¸å…¶ä»–åç«¯å¯¹æ¯”" tabindex="-1">ä¸å…¶ä»–åç«¯å¯¹æ¯” <a class="header-anchor" href="#ä¸å…¶ä»–åç«¯å¯¹æ¯”" aria-label="Permalink to &quot;ä¸å…¶ä»–åç«¯å¯¹æ¯”&quot;">â€‹</a></h2><table tabindex="0"><thead><tr><th>ç‰¹æ€§</th><th>Go Fiber</th><th>NestJS</th><th>FastAPI</th><th>Spring Boot</th></tr></thead><tbody><tr><td>è¯­è¨€</td><td>Go</td><td>TypeScript</td><td>Python</td><td>Java</td></tr><tr><td>ORM</td><td>GORM</td><td>Prisma</td><td>SQLAlchemy</td><td>JPA</td></tr><tr><td>æ€§èƒ½</td><td>â­â­â­â­â­</td><td>â­â­â­â­</td><td>â­â­â­â­</td><td>â­â­â­</td></tr><tr><td>å­¦ä¹ æ›²çº¿</td><td>â­â­â­â­</td><td>â­â­â­</td><td>â­â­â­â­</td><td>â­â­</td></tr></tbody></table><h2 id="ç›¸å…³é“¾æ¥" tabindex="-1">ç›¸å…³é“¾æ¥ <a class="header-anchor" href="#ç›¸å…³é“¾æ¥" aria-label="Permalink to &quot;ç›¸å…³é“¾æ¥&quot;">â€‹</a></h2><ul><li><a href="https://halolight-api-go.h7ml.cn/docs" target="_blank" rel="noreferrer">API æ–‡æ¡£</a></li><li><a href="https://github.com/halolight/halolight-api-go" target="_blank" rel="noreferrer">GitHub ä»“åº“</a></li><li><a href="https://docs.gofiber.io" target="_blank" rel="noreferrer">Fiber å®˜æ–¹æ–‡æ¡£</a></li><li><a href="https://docs.halolight.h7ml.cn" target="_blank" rel="noreferrer">HaloLight æ–‡æ¡£</a></li></ul>`,105)])])}const E=a(e,[["render",l]]);export{c as __pageData,E as default};
