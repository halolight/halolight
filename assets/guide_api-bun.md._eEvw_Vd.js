import{_ as a,c as i,o as n,a3 as t}from"./chunks/framework.BuRUkFgc.js";const o=JSON.parse('{"title":"Bun Hono åç«¯ API","description":"","frontmatter":{},"headers":[],"relativePath":"guide/api-bun.md","filePath":"guide/api-bun.md","lastUpdated":1765973614000}'),e={name:"guide/api-bun.md"};function l(p,s,h,r,d,k){return n(),i("div",{"data-pagefind-body":!0,"data-pagefind-meta":"date:1765973614000"},[...s[0]||(s[0]=[t(`<h1 id="bun-hono-åç«¯-api" tabindex="-1">Bun Hono åç«¯ API <a class="header-anchor" href="#bun-hono-åç«¯-api" aria-label="Permalink to &quot;Bun Hono åç«¯ API&quot;">â€‹</a></h1><p>HaloLight Bun åç«¯ API åŸºäº Bun + Hono + Drizzle ORM æ„å»ºï¼Œæä¾›è¶…é«˜æ€§èƒ½åç«¯æœåŠ¡ã€‚</p><p><strong>API æ–‡æ¡£</strong>ï¼š<a href="https://halolight-api-bun.h7ml.cn/docs" target="_blank" rel="noreferrer">https://halolight-api-bun.h7ml.cn/docs</a></p><p><strong>GitHub</strong>ï¼š<a href="https://github.com/halolight/halolight-api-bun" target="_blank" rel="noreferrer">https://github.com/halolight/halolight-api-bun</a></p><h2 id="ç‰¹æ€§" tabindex="-1">ç‰¹æ€§ <a class="header-anchor" href="#ç‰¹æ€§" aria-label="Permalink to &quot;ç‰¹æ€§&quot;">â€‹</a></h2><ul><li>ğŸ” <strong>JWT åŒä»¤ç‰Œ</strong> - Access Token + Refresh Tokenï¼Œè‡ªåŠ¨ç»­æœŸ</li><li>ğŸ›¡ï¸ <strong>RBAC æƒé™</strong> - åŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶ï¼Œé€šé…ç¬¦åŒ¹é…</li><li>ğŸ“¡ <strong>RESTful API</strong> - æ ‡å‡†åŒ–æ¥å£è®¾è®¡ï¼ŒOpenAPI æ–‡æ¡£</li><li>ğŸ—„ï¸ <strong>Drizzle ORM</strong> - ç±»å‹å®‰å…¨çš„æ•°æ®åº“æ“ä½œ</li><li>âœ… <strong>æ•°æ®éªŒè¯</strong> - è¯·æ±‚å‚æ•°æ ¡éªŒï¼Œé”™è¯¯å¤„ç†</li><li>ğŸ“Š <strong>æ—¥å¿—ç³»ç»Ÿ</strong> - è¯·æ±‚æ—¥å¿—ï¼Œé”™è¯¯è¿½è¸ª</li><li>ğŸ³ <strong>Docker æ”¯æŒ</strong> - å®¹å™¨åŒ–éƒ¨ç½²</li><li>âš¡ <strong>æé€Ÿæ€§èƒ½</strong> - æ¯” Node.js å¿« 4 å€</li></ul><h2 id="æŠ€æœ¯æ ˆ" tabindex="-1">æŠ€æœ¯æ ˆ <a class="header-anchor" href="#æŠ€æœ¯æ ˆ" aria-label="Permalink to &quot;æŠ€æœ¯æ ˆ&quot;">â€‹</a></h2><table tabindex="0"><thead><tr><th>æŠ€æœ¯</th><th>ç‰ˆæœ¬</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>Bun</td><td>1.1+</td><td>è¿è¡Œæ—¶</td></tr><tr><td>Hono</td><td>4.x</td><td>Web æ¡†æ¶</td></tr><tr><td>Drizzle ORM</td><td>0.36+</td><td>æ•°æ®åº“ ORM</td></tr><tr><td>PostgreSQL</td><td>15+</td><td>æ•°æ®å­˜å‚¨</td></tr><tr><td>Zod</td><td>3.x</td><td>æ•°æ®éªŒè¯</td></tr><tr><td>JWT</td><td>-</td><td>èº«ä»½è®¤è¯</td></tr><tr><td>Swagger</td><td>-</td><td>API æ–‡æ¡£</td></tr></tbody></table><h2 id="å¿«é€Ÿå¼€å§‹" tabindex="-1">å¿«é€Ÿå¼€å§‹ <a class="header-anchor" href="#å¿«é€Ÿå¼€å§‹" aria-label="Permalink to &quot;å¿«é€Ÿå¼€å§‹&quot;">â€‹</a></h2><h3 id="ç¯å¢ƒè¦æ±‚" tabindex="-1">ç¯å¢ƒè¦æ±‚ <a class="header-anchor" href="#ç¯å¢ƒè¦æ±‚" aria-label="Permalink to &quot;ç¯å¢ƒè¦æ±‚&quot;">â€‹</a></h3><ul><li>Bun &gt;= 1.1</li><li>pnpm &gt;= 8.0</li><li>PostgreSQL (å¯é€‰ï¼Œé»˜è®¤ SQLite)</li></ul><h3 id="å®‰è£…" tabindex="-1">å®‰è£… <a class="header-anchor" href="#å®‰è£…" aria-label="Permalink to &quot;å®‰è£…&quot;">â€‹</a></h3><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å…‹éš†ä»“åº“</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> clone</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://github.com/halolight/halolight-api-bun.git</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> halolight-api-bun</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å®‰è£…ä¾èµ–</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pnpm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="ç¯å¢ƒå˜é‡" tabindex="-1">ç¯å¢ƒå˜é‡ <a class="header-anchor" href="#ç¯å¢ƒå˜é‡" aria-label="Permalink to &quot;ç¯å¢ƒå˜é‡&quot;">â€‹</a></h3><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> .env.example</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> .env</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-env vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">env</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span># æ•°æ®åº“</span></span>
<span class="line"><span>DATABASE_URL=postgresql://user:password@localhost:5432/halolight</span></span>
<span class="line"><span></span></span>
<span class="line"><span># JWT å¯†é’¥</span></span>
<span class="line"><span>JWT_SECRET=your-super-secret-key</span></span>
<span class="line"><span>JWT_ACCESS_EXPIRES=15m</span></span>
<span class="line"><span>JWT_REFRESH_EXPIRES=7d</span></span>
<span class="line"><span></span></span>
<span class="line"><span># æœåŠ¡é…ç½®</span></span>
<span class="line"><span>PORT=3002</span></span>
<span class="line"><span>NODE_ENV=development</span></span>
<span class="line"><span>CORS_ORIGIN=http://localhost:3000</span></span>
<span class="line"><span>API_PREFIX=/api</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h3 id="æ•°æ®åº“åˆå§‹åŒ–" tabindex="-1">æ•°æ®åº“åˆå§‹åŒ– <a class="header-anchor" href="#æ•°æ®åº“åˆå§‹åŒ–" aria-label="Permalink to &quot;æ•°æ®åº“åˆå§‹åŒ–&quot;">â€‹</a></h3><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">bun</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> db:push</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">bun</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> db:seed</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="å¯åŠ¨æœåŠ¡" tabindex="-1">å¯åŠ¨æœåŠ¡ <a class="header-anchor" href="#å¯åŠ¨æœåŠ¡" aria-label="Permalink to &quot;å¯åŠ¨æœåŠ¡&quot;">â€‹</a></h3><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å¼€å‘æ¨¡å¼</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">bun</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dev</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ç”Ÿäº§æ¨¡å¼</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">bun</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> build</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">bun</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> start</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>è®¿é—® <a href="http://localhost:3002" target="_blank" rel="noreferrer">http://localhost:3002</a></p><h2 id="é¡¹ç›®ç»“æ„" tabindex="-1">é¡¹ç›®ç»“æ„ <a class="header-anchor" href="#é¡¹ç›®ç»“æ„" aria-label="Permalink to &quot;é¡¹ç›®ç»“æ„&quot;">â€‹</a></h2><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>halolight-api-bun/</span></span>
<span class="line"><span>â”œâ”€â”€ src/</span></span>
<span class="line"><span>â”‚   â”œâ”€â”€ routes/          # æ§åˆ¶å™¨/è·¯ç”±å¤„ç†</span></span>
<span class="line"><span>â”‚   â”œâ”€â”€ services/        # ä¸šåŠ¡é€»è¾‘å±‚</span></span>
<span class="line"><span>â”‚   â”œâ”€â”€ db/              # æ•°æ®æ¨¡å‹</span></span>
<span class="line"><span>â”‚   â”œâ”€â”€ middleware/      # ä¸­é—´ä»¶</span></span>
<span class="line"><span>â”‚   â”œâ”€â”€ utils/           # å·¥å…·å‡½æ•°</span></span>
<span class="line"><span>â”‚   â””â”€â”€ index.ts         # åº”ç”¨å…¥å£</span></span>
<span class="line"><span>â”œâ”€â”€ test/                # æµ‹è¯•æ–‡ä»¶</span></span>
<span class="line"><span>â”œâ”€â”€ Dockerfile           # Docker é…ç½®</span></span>
<span class="line"><span>â”œâ”€â”€ docker-compose.yml</span></span>
<span class="line"><span>â””â”€â”€ package.json</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h2 id="api-æ¨¡å—" tabindex="-1">API æ¨¡å— <a class="header-anchor" href="#api-æ¨¡å—" aria-label="Permalink to &quot;API æ¨¡å—&quot;">â€‹</a></h2><h3 id="è®¤è¯ç›¸å…³ç«¯ç‚¹" tabindex="-1">è®¤è¯ç›¸å…³ç«¯ç‚¹ <a class="header-anchor" href="#è®¤è¯ç›¸å…³ç«¯ç‚¹" aria-label="Permalink to &quot;è®¤è¯ç›¸å…³ç«¯ç‚¹&quot;">â€‹</a></h3><table tabindex="0"><thead><tr><th>æ–¹æ³•</th><th>è·¯å¾„</th><th>æè¿°</th><th>æƒé™</th></tr></thead><tbody><tr><td>POST</td><td><code>/api/auth/login</code></td><td>ç”¨æˆ·ç™»å½•</td><td>å…¬å¼€</td></tr><tr><td>POST</td><td><code>/api/auth/register</code></td><td>ç”¨æˆ·æ³¨å†Œ</td><td>å…¬å¼€</td></tr><tr><td>POST</td><td><code>/api/auth/refresh</code></td><td>åˆ·æ–°ä»¤ç‰Œ</td><td>å…¬å¼€</td></tr><tr><td>POST</td><td><code>/api/auth/logout</code></td><td>é€€å‡ºç™»å½•</td><td>éœ€è®¤è¯</td></tr><tr><td>POST</td><td><code>/api/auth/forgot-password</code></td><td>å¿˜è®°å¯†ç </td><td>å…¬å¼€</td></tr><tr><td>POST</td><td><code>/api/auth/reset-password</code></td><td>é‡ç½®å¯†ç </td><td>å…¬å¼€</td></tr></tbody></table><h3 id="ç”¨æˆ·ç®¡ç†ç«¯ç‚¹" tabindex="-1">ç”¨æˆ·ç®¡ç†ç«¯ç‚¹ <a class="header-anchor" href="#ç”¨æˆ·ç®¡ç†ç«¯ç‚¹" aria-label="Permalink to &quot;ç”¨æˆ·ç®¡ç†ç«¯ç‚¹&quot;">â€‹</a></h3><table tabindex="0"><thead><tr><th>æ–¹æ³•</th><th>è·¯å¾„</th><th>æè¿°</th><th>æƒé™</th></tr></thead><tbody><tr><td>GET</td><td><code>/api/users</code></td><td>è·å–ç”¨æˆ·åˆ—è¡¨</td><td><code>users:view</code></td></tr><tr><td>GET</td><td><code>/api/users/:id</code></td><td>è·å–ç”¨æˆ·è¯¦æƒ…</td><td><code>users:view</code></td></tr><tr><td>POST</td><td><code>/api/users</code></td><td>åˆ›å»ºç”¨æˆ·</td><td><code>users:create</code></td></tr><tr><td>PUT</td><td><code>/api/users/:id</code></td><td>æ›´æ–°ç”¨æˆ·</td><td><code>users:update</code></td></tr><tr><td>DELETE</td><td><code>/api/users/:id</code></td><td>åˆ é™¤ç”¨æˆ·</td><td><code>users:delete</code></td></tr><tr><td>GET</td><td><code>/api/users/me</code></td><td>è·å–å½“å‰ç”¨æˆ·</td><td>éœ€è®¤è¯</td></tr></tbody></table><h3 id="å®Œæ•´ç«¯ç‚¹æ¸…å•" tabindex="-1">å®Œæ•´ç«¯ç‚¹æ¸…å• <a class="header-anchor" href="#å®Œæ•´ç«¯ç‚¹æ¸…å•" aria-label="Permalink to &quot;å®Œæ•´ç«¯ç‚¹æ¸…å•&quot;">â€‹</a></h3><h4 id="æ–‡æ¡£ç®¡ç†-documents-5-ä¸ªç«¯ç‚¹" tabindex="-1">æ–‡æ¡£ç®¡ç† (Documents) - 5 ä¸ªç«¯ç‚¹ <a class="header-anchor" href="#æ–‡æ¡£ç®¡ç†-documents-5-ä¸ªç«¯ç‚¹" aria-label="Permalink to &quot;æ–‡æ¡£ç®¡ç† (Documents) - 5 ä¸ªç«¯ç‚¹&quot;">â€‹</a></h4><table tabindex="0"><thead><tr><th>æ–¹æ³•</th><th>è·¯å¾„</th><th>æè¿°</th></tr></thead><tbody><tr><td>GET</td><td><code>/api/documents</code></td><td>è·å–æ–‡æ¡£åˆ—è¡¨</td></tr><tr><td>GET</td><td><code>/api/documents/:id</code></td><td>è·å–æ–‡æ¡£è¯¦æƒ…</td></tr><tr><td>POST</td><td><code>/api/documents</code></td><td>åˆ›å»ºæ–‡æ¡£</td></tr><tr><td>PUT</td><td><code>/api/documents/:id</code></td><td>æ›´æ–°æ–‡æ¡£</td></tr><tr><td>DELETE</td><td><code>/api/documents/:id</code></td><td>åˆ é™¤æ–‡æ¡£</td></tr></tbody></table><h4 id="æ–‡ä»¶ç®¡ç†-files-5-ä¸ªç«¯ç‚¹" tabindex="-1">æ–‡ä»¶ç®¡ç† (Files) - 5 ä¸ªç«¯ç‚¹ <a class="header-anchor" href="#æ–‡ä»¶ç®¡ç†-files-5-ä¸ªç«¯ç‚¹" aria-label="Permalink to &quot;æ–‡ä»¶ç®¡ç† (Files) - 5 ä¸ªç«¯ç‚¹&quot;">â€‹</a></h4><table tabindex="0"><thead><tr><th>æ–¹æ³•</th><th>è·¯å¾„</th><th>æè¿°</th></tr></thead><tbody><tr><td>GET</td><td><code>/api/files</code></td><td>è·å–æ–‡ä»¶åˆ—è¡¨</td></tr><tr><td>GET</td><td><code>/api/files/:id</code></td><td>è·å–æ–‡ä»¶è¯¦æƒ…</td></tr><tr><td>POST</td><td><code>/api/files/upload</code></td><td>ä¸Šä¼ æ–‡ä»¶</td></tr><tr><td>PUT</td><td><code>/api/files/:id</code></td><td>æ›´æ–°æ–‡ä»¶ä¿¡æ¯</td></tr><tr><td>DELETE</td><td><code>/api/files/:id</code></td><td>åˆ é™¤æ–‡ä»¶</td></tr></tbody></table><h4 id="æ¶ˆæ¯ç®¡ç†-messages-5-ä¸ªç«¯ç‚¹" tabindex="-1">æ¶ˆæ¯ç®¡ç† (Messages) - 5 ä¸ªç«¯ç‚¹ <a class="header-anchor" href="#æ¶ˆæ¯ç®¡ç†-messages-5-ä¸ªç«¯ç‚¹" aria-label="Permalink to &quot;æ¶ˆæ¯ç®¡ç† (Messages) - 5 ä¸ªç«¯ç‚¹&quot;">â€‹</a></h4><table tabindex="0"><thead><tr><th>æ–¹æ³•</th><th>è·¯å¾„</th><th>æè¿°</th></tr></thead><tbody><tr><td>GET</td><td><code>/api/messages</code></td><td>è·å–æ¶ˆæ¯åˆ—è¡¨</td></tr><tr><td>GET</td><td><code>/api/messages/:id</code></td><td>è·å–æ¶ˆæ¯è¯¦æƒ…</td></tr><tr><td>POST</td><td><code>/api/messages</code></td><td>å‘é€æ¶ˆæ¯</td></tr><tr><td>PUT</td><td><code>/api/messages/:id/read</code></td><td>æ ‡è®°å·²è¯»</td></tr><tr><td>DELETE</td><td><code>/api/messages/:id</code></td><td>åˆ é™¤æ¶ˆæ¯</td></tr></tbody></table><h4 id="é€šçŸ¥ç®¡ç†-notifications-4-ä¸ªç«¯ç‚¹" tabindex="-1">é€šçŸ¥ç®¡ç† (Notifications) - 4 ä¸ªç«¯ç‚¹ <a class="header-anchor" href="#é€šçŸ¥ç®¡ç†-notifications-4-ä¸ªç«¯ç‚¹" aria-label="Permalink to &quot;é€šçŸ¥ç®¡ç† (Notifications) - 4 ä¸ªç«¯ç‚¹&quot;">â€‹</a></h4><table tabindex="0"><thead><tr><th>æ–¹æ³•</th><th>è·¯å¾„</th><th>æè¿°</th></tr></thead><tbody><tr><td>GET</td><td><code>/api/notifications</code></td><td>è·å–é€šçŸ¥åˆ—è¡¨</td></tr><tr><td>PUT</td><td><code>/api/notifications/:id/read</code></td><td>æ ‡è®°å·²è¯»</td></tr><tr><td>PUT</td><td><code>/api/notifications/read-all</code></td><td>å…¨éƒ¨å·²è¯»</td></tr><tr><td>DELETE</td><td><code>/api/notifications/:id</code></td><td>åˆ é™¤é€šçŸ¥</td></tr></tbody></table><h4 id="æ—¥å†ç®¡ç†-calendar-5-ä¸ªç«¯ç‚¹" tabindex="-1">æ—¥å†ç®¡ç† (Calendar) - 5 ä¸ªç«¯ç‚¹ <a class="header-anchor" href="#æ—¥å†ç®¡ç†-calendar-5-ä¸ªç«¯ç‚¹" aria-label="Permalink to &quot;æ—¥å†ç®¡ç† (Calendar) - 5 ä¸ªç«¯ç‚¹&quot;">â€‹</a></h4><table tabindex="0"><thead><tr><th>æ–¹æ³•</th><th>è·¯å¾„</th><th>æè¿°</th></tr></thead><tbody><tr><td>GET</td><td><code>/api/calendar/events</code></td><td>è·å–æ—¥ç¨‹åˆ—è¡¨</td></tr><tr><td>GET</td><td><code>/api/calendar/events/:id</code></td><td>è·å–æ—¥ç¨‹è¯¦æƒ…</td></tr><tr><td>POST</td><td><code>/api/calendar/events</code></td><td>åˆ›å»ºæ—¥ç¨‹</td></tr><tr><td>PUT</td><td><code>/api/calendar/events/:id</code></td><td>æ›´æ–°æ—¥ç¨‹</td></tr><tr><td>DELETE</td><td><code>/api/calendar/events/:id</code></td><td>åˆ é™¤æ—¥ç¨‹</td></tr></tbody></table><h4 id="ä»ªè¡¨ç›˜-dashboard-6-ä¸ªç«¯ç‚¹" tabindex="-1">ä»ªè¡¨ç›˜ (Dashboard) - 6 ä¸ªç«¯ç‚¹ <a class="header-anchor" href="#ä»ªè¡¨ç›˜-dashboard-6-ä¸ªç«¯ç‚¹" aria-label="Permalink to &quot;ä»ªè¡¨ç›˜ (Dashboard) - 6 ä¸ªç«¯ç‚¹&quot;">â€‹</a></h4><table tabindex="0"><thead><tr><th>æ–¹æ³•</th><th>è·¯å¾„</th><th>æè¿°</th></tr></thead><tbody><tr><td>GET</td><td><code>/api/dashboard/stats</code></td><td>ç»Ÿè®¡æ•°æ®</td></tr><tr><td>GET</td><td><code>/api/dashboard/visits</code></td><td>è®¿é—®è¶‹åŠ¿</td></tr><tr><td>GET</td><td><code>/api/dashboard/sales</code></td><td>é”€å”®æ•°æ®</td></tr><tr><td>GET</td><td><code>/api/dashboard/pie</code></td><td>é¥¼å›¾æ•°æ®</td></tr><tr><td>GET</td><td><code>/api/dashboard/tasks</code></td><td>å¾…åŠä»»åŠ¡</td></tr><tr><td>GET</td><td><code>/api/dashboard/calendar</code></td><td>ä»Šæ—¥æ—¥ç¨‹</td></tr></tbody></table><h2 id="è®¤è¯æœºåˆ¶" tabindex="-1">è®¤è¯æœºåˆ¶ <a class="header-anchor" href="#è®¤è¯æœºåˆ¶" aria-label="Permalink to &quot;è®¤è¯æœºåˆ¶&quot;">â€‹</a></h2><h3 id="jwt-åŒä»¤ç‰Œ" tabindex="-1">JWT åŒä»¤ç‰Œ <a class="header-anchor" href="#jwt-åŒä»¤ç‰Œ" aria-label="Permalink to &quot;JWT åŒä»¤ç‰Œ&quot;">â€‹</a></h3><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Access Token:  15 åˆ†é’Ÿæœ‰æ•ˆæœŸï¼Œç”¨äº API è¯·æ±‚</span></span>
<span class="line"><span>Refresh Token: 7 å¤©æœ‰æ•ˆæœŸï¼Œç”¨äºåˆ·æ–° Access Token</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="è¯·æ±‚å¤´" tabindex="-1">è¯·æ±‚å¤´ <a class="header-anchor" href="#è¯·æ±‚å¤´" aria-label="Permalink to &quot;è¯·æ±‚å¤´&quot;">â€‹</a></h3><div class="language-http vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">http</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Authorization</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Bearer &lt;access_token&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="åˆ·æ–°æµç¨‹" tabindex="-1">åˆ·æ–°æµç¨‹ <a class="header-anchor" href="#åˆ·æ–°æµç¨‹" aria-label="Permalink to &quot;åˆ·æ–°æµç¨‹&quot;">â€‹</a></h3><div class="language-typescript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// åˆ·æ–°ä»¤ç‰Œç¤ºä¾‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> response</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> fetch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;/api/auth/refresh&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  method: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;POST&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  headers: {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;Content-Type&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;application/json&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  body: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">JSON</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">stringify</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    refreshToken: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;your_refresh_token&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">accessToken</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">refreshToken</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> response.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">json</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h2 id="æƒé™ç³»ç»Ÿ" tabindex="-1">æƒé™ç³»ç»Ÿ <a class="header-anchor" href="#æƒé™ç³»ç»Ÿ" aria-label="Permalink to &quot;æƒé™ç³»ç»Ÿ&quot;">â€‹</a></h2><h3 id="è§’è‰²å®šä¹‰" tabindex="-1">è§’è‰²å®šä¹‰ <a class="header-anchor" href="#è§’è‰²å®šä¹‰" aria-label="Permalink to &quot;è§’è‰²å®šä¹‰&quot;">â€‹</a></h3><table tabindex="0"><thead><tr><th>è§’è‰²</th><th>è¯´æ˜</th><th>æƒé™</th></tr></thead><tbody><tr><td><code>super_admin</code></td><td>è¶…çº§ç®¡ç†å‘˜</td><td><code>*</code> (æ‰€æœ‰æƒé™)</td></tr><tr><td><code>admin</code></td><td>ç®¡ç†å‘˜</td><td><code>users:*</code>, <code>documents:*</code>, ...</td></tr><tr><td><code>user</code></td><td>æ™®é€šç”¨æˆ·</td><td><code>documents:view</code>, <code>files:view</code>, ...</td></tr><tr><td><code>guest</code></td><td>è®¿å®¢</td><td><code>dashboard:view</code></td></tr></tbody></table><h3 id="æƒé™æ ¼å¼" tabindex="-1">æƒé™æ ¼å¼ <a class="header-anchor" href="#æƒé™æ ¼å¼" aria-label="Permalink to &quot;æƒé™æ ¼å¼&quot;">â€‹</a></h3><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>{resource}:{action}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>ç¤ºä¾‹ï¼š</span></span>
<span class="line"><span>- users:view      # æŸ¥çœ‹ç”¨æˆ·</span></span>
<span class="line"><span>- users:create    # åˆ›å»ºç”¨æˆ·</span></span>
<span class="line"><span>- users:*         # ç”¨æˆ·æ‰€æœ‰æ“ä½œ</span></span>
<span class="line"><span>- *               # æ‰€æœ‰æƒé™</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h2 id="é”™è¯¯å¤„ç†" tabindex="-1">é”™è¯¯å¤„ç† <a class="header-anchor" href="#é”™è¯¯å¤„ç†" aria-label="Permalink to &quot;é”™è¯¯å¤„ç†&quot;">â€‹</a></h2><h3 id="é”™è¯¯å“åº”æ ¼å¼" tabindex="-1">é”™è¯¯å“åº”æ ¼å¼ <a class="header-anchor" href="#é”™è¯¯å“åº”æ ¼å¼" aria-label="Permalink to &quot;é”™è¯¯å“åº”æ ¼å¼&quot;">â€‹</a></h3><div class="language-json vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;success&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;error&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;code&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;VALIDATION_ERROR&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;message&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;è¯·æ±‚å‚æ•°éªŒè¯å¤±è´¥&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;details&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      { </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">&quot;field&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;email&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">&quot;message&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;é‚®ç®±æ ¼å¼ä¸æ­£ç¡®&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h3 id="é”™è¯¯ç " tabindex="-1">é”™è¯¯ç  <a class="header-anchor" href="#é”™è¯¯ç " aria-label="Permalink to &quot;é”™è¯¯ç &quot;">â€‹</a></h3><table tabindex="0"><thead><tr><th>çŠ¶æ€ç </th><th>é”™è¯¯ç </th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>400</td><td><code>VALIDATION_ERROR</code></td><td>å‚æ•°éªŒè¯å¤±è´¥</td></tr><tr><td>401</td><td><code>UNAUTHORIZED</code></td><td>æœªæˆæƒ</td></tr><tr><td>403</td><td><code>FORBIDDEN</code></td><td>æ— æƒé™</td></tr><tr><td>404</td><td><code>NOT_FOUND</code></td><td>èµ„æºä¸å­˜åœ¨</td></tr><tr><td>409</td><td><code>CONFLICT</code></td><td>èµ„æºå†²çª</td></tr><tr><td>500</td><td><code>INTERNAL_ERROR</code></td><td>æœåŠ¡å™¨é”™è¯¯</td></tr></tbody></table><h2 id="å¸¸ç”¨å‘½ä»¤" tabindex="-1">å¸¸ç”¨å‘½ä»¤ <a class="header-anchor" href="#å¸¸ç”¨å‘½ä»¤" aria-label="Permalink to &quot;å¸¸ç”¨å‘½ä»¤&quot;">â€‹</a></h2><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å¼€å‘</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">bun</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dev</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                 # å¯åŠ¨å¼€å‘æœåŠ¡å™¨</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">bun</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> build</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">               # ç”Ÿäº§æ„å»º</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">bun</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> start</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">               # è¿è¡Œç”Ÿäº§ç‰ˆæœ¬</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># æ„å»º</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">bun</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> build</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">               # æ„å»ºç”Ÿäº§ç‰ˆæœ¬</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># æµ‹è¯•</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">bun</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> test</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                    # è¿è¡Œå•å…ƒæµ‹è¯•</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">bun</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> test</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --coverage</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">         # ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># æ•°æ®åº“</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">bun</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> db:push</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">             # æ¨é€ Schema åˆ°æ•°æ®åº“</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">bun</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> db:generate</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">         # ç”Ÿæˆè¿ç§»æ–‡ä»¶</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">bun</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> db:migrate</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">          # è¿è¡Œæ•°æ®åº“è¿ç§»</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">bun</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> db:seed</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">             # å¡«å……æµ‹è¯•æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">bun</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> db:studio</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">           # æ‰“å¼€ Drizzle Studio</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ä»£ç è´¨é‡</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">bun</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> lint</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                # ESLint æ£€æŸ¥</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">bun</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> lint:fix</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">            # ESLint è‡ªåŠ¨ä¿®å¤</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">bun</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> type-check</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">          # TypeScript ç±»å‹æ£€æŸ¥</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><h2 id="éƒ¨ç½²" tabindex="-1">éƒ¨ç½² <a class="header-anchor" href="#éƒ¨ç½²" aria-label="Permalink to &quot;éƒ¨ç½²&quot;">â€‹</a></h2><h3 id="docker" tabindex="-1">Docker <a class="header-anchor" href="#docker" aria-label="Permalink to &quot;Docker&quot;">â€‹</a></h3><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> build</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -t</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> halolight-api-bun</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> .</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 3002:3002</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> halolight-api-bun</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="docker-compose" tabindex="-1">Docker Compose <a class="header-anchor" href="#docker-compose" aria-label="Permalink to &quot;Docker Compose&quot;">â€‹</a></h3><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker-compose</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> up</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -d</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-yaml vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># docker-compose.yml</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">version</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;3.8&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">services</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  app</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    build</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">.</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    ports</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;3002:3002&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    environment</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">NODE_ENV=production</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">DATABASE_URL=\${DATABASE_URL}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">JWT_SECRET=\${JWT_SECRET}</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    restart</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">unless-stopped</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  db</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    image</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">postgres:16-alpine</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    environment</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      POSTGRES_DB</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">halolight</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      POSTGRES_USER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">\${DB_USER}</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      POSTGRES_PASSWORD</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">\${DB_PASSWORD}</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    volumes</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">postgres_data:/var/lib/postgresql/data</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">volumes</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  postgres_data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><h3 id="ç”Ÿäº§ç¯å¢ƒé…ç½®" tabindex="-1">ç”Ÿäº§ç¯å¢ƒé…ç½® <a class="header-anchor" href="#ç”Ÿäº§ç¯å¢ƒé…ç½®" aria-label="Permalink to &quot;ç”Ÿäº§ç¯å¢ƒé…ç½®&quot;">â€‹</a></h3><div class="language-env vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">env</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>NODE_ENV=production</span></span>
<span class="line"><span>DATABASE_URL=postgresql://user:pass@host:5432/db</span></span>
<span class="line"><span>JWT_SECRET=your-production-secret</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="æµ‹è¯•" tabindex="-1">æµ‹è¯• <a class="header-anchor" href="#æµ‹è¯•" aria-label="Permalink to &quot;æµ‹è¯•&quot;">â€‹</a></h2><h3 id="è¿è¡Œæµ‹è¯•" tabindex="-1">è¿è¡Œæµ‹è¯• <a class="header-anchor" href="#è¿è¡Œæµ‹è¯•" aria-label="Permalink to &quot;è¿è¡Œæµ‹è¯•&quot;">â€‹</a></h3><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">bun</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> test</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                    # è¿è¡Œæ‰€æœ‰æµ‹è¯•</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">bun</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> test</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --coverage</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">         # ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="æµ‹è¯•ç¤ºä¾‹" tabindex="-1">æµ‹è¯•ç¤ºä¾‹ <a class="header-anchor" href="#æµ‹è¯•ç¤ºä¾‹" aria-label="Permalink to &quot;æµ‹è¯•ç¤ºä¾‹&quot;">â€‹</a></h3><div class="language-typescript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// è®¤è¯æµ‹è¯•ç¤ºä¾‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { describe, test, expect } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;bun:test&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">describe</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Auth API&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  test</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;should login successfully&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">async</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> response</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> fetch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;http://localhost:3002/api/auth/login&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      method: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;POST&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      headers: { </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Content-Type&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;application/json&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      body: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">JSON</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">stringify</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        email: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;admin@example.com&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        password: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;admin123&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> data</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> response.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">json</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    expect</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(data.success).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">toBe</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    expect</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(data.data.accessToken).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">toBeDefined</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><h2 id="æ€§èƒ½æŒ‡æ ‡" tabindex="-1">æ€§èƒ½æŒ‡æ ‡ <a class="header-anchor" href="#æ€§èƒ½æŒ‡æ ‡" aria-label="Permalink to &quot;æ€§èƒ½æŒ‡æ ‡&quot;">â€‹</a></h2><h3 id="åŸºå‡†æµ‹è¯•" tabindex="-1">åŸºå‡†æµ‹è¯• <a class="header-anchor" href="#åŸºå‡†æµ‹è¯•" aria-label="Permalink to &quot;åŸºå‡†æµ‹è¯•&quot;">â€‹</a></h3><table tabindex="0"><thead><tr><th>æŒ‡æ ‡</th><th>æ•°å€¼</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>è¯·æ±‚ååé‡</td><td>~50,000 req/s</td><td>å•æ ¸ï¼Œç®€å•è·¯ç”±</td></tr><tr><td>å¹³å‡å“åº”æ—¶é—´</td><td>&lt;5ms</td><td>æœ¬åœ°æ•°æ®åº“</td></tr><tr><td>å†…å­˜å ç”¨</td><td>~30MB</td><td>å†·å¯åŠ¨</td></tr><tr><td>CPU ä½¿ç”¨ç‡</td><td>&lt;10%</td><td>ç©ºé—²çŠ¶æ€</td></tr></tbody></table><h2 id="å¯è§‚æµ‹æ€§" tabindex="-1">å¯è§‚æµ‹æ€§ <a class="header-anchor" href="#å¯è§‚æµ‹æ€§" aria-label="Permalink to &quot;å¯è§‚æµ‹æ€§&quot;">â€‹</a></h2><h3 id="æ—¥å¿—ç³»ç»Ÿ" tabindex="-1">æ—¥å¿—ç³»ç»Ÿ <a class="header-anchor" href="#æ—¥å¿—ç³»ç»Ÿ" aria-label="Permalink to &quot;æ—¥å¿—ç³»ç»Ÿ&quot;">â€‹</a></h3><div class="language-typescript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// æ—¥å¿—é…ç½®ç¤ºä¾‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { logger } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;./utils/logger&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">logger.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">info</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;User logged in&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, { userId: user.id });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">logger.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Database error&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, { error: err.message });</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="å¥åº·æ£€æŸ¥" tabindex="-1">å¥åº·æ£€æŸ¥ <a class="header-anchor" href="#å¥åº·æ£€æŸ¥" aria-label="Permalink to &quot;å¥åº·æ£€æŸ¥&quot;">â€‹</a></h3><div class="language-typescript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// GET /health</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">app.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">get</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;/health&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">c</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> c.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">json</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    status: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;healthy&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    timestamp: </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Date</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">toISOString</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    uptime: process.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">uptime</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="ç›‘æ§æŒ‡æ ‡" tabindex="-1">ç›‘æ§æŒ‡æ ‡ <a class="header-anchor" href="#ç›‘æ§æŒ‡æ ‡" aria-label="Permalink to &quot;ç›‘æ§æŒ‡æ ‡&quot;">â€‹</a></h3><div class="language-typescript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Prometheus metrics ç«¯ç‚¹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">app.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">get</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;/metrics&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">async</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">c</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> c.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">text</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> register.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">metrics</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">());</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="å¸¸è§é—®é¢˜" tabindex="-1">å¸¸è§é—®é¢˜ <a class="header-anchor" href="#å¸¸è§é—®é¢˜" aria-label="Permalink to &quot;å¸¸è§é—®é¢˜&quot;">â€‹</a></h2><h3 id="q-å¦‚ä½•é…ç½®æ•°æ®åº“è¿æ¥" tabindex="-1">Qï¼šå¦‚ä½•é…ç½®æ•°æ®åº“è¿æ¥ï¼Ÿ <a class="header-anchor" href="#q-å¦‚ä½•é…ç½®æ•°æ®åº“è¿æ¥" aria-label="Permalink to &quot;Qï¼šå¦‚ä½•é…ç½®æ•°æ®åº“è¿æ¥ï¼Ÿ&quot;">â€‹</a></h3><p>Aï¼šåœ¨ <code>.env</code> æ–‡ä»¶ä¸­è®¾ç½® <code>DATABASE_URL</code>ï¼š</p><div class="language-env vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">env</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>DATABASE_URL=postgresql://user:password@localhost:5432/halolight</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="q-å¦‚ä½•ä½¿ç”¨-bun-å†…ç½®å¯†ç å“ˆå¸Œ" tabindex="-1">Qï¼šå¦‚ä½•ä½¿ç”¨ Bun å†…ç½®å¯†ç å“ˆå¸Œï¼Ÿ <a class="header-anchor" href="#q-å¦‚ä½•ä½¿ç”¨-bun-å†…ç½®å¯†ç å“ˆå¸Œ" aria-label="Permalink to &quot;Qï¼šå¦‚ä½•ä½¿ç”¨ Bun å†…ç½®å¯†ç å“ˆå¸Œï¼Ÿ&quot;">â€‹</a></h3><p>Aï¼šä½¿ç”¨ <code>Bun.password</code> APIï¼š</p><div class="language-typescript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// å“ˆå¸Œå¯†ç </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> hash</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Bun.password.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">hash</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(password, {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  algorithm: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;bcrypt&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  cost: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// éªŒè¯å¯†ç </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> isValid</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Bun.password.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">verify</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(password, hash, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;bcrypt&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="å¼€å‘å·¥å…·" tabindex="-1">å¼€å‘å·¥å…· <a class="header-anchor" href="#å¼€å‘å·¥å…·" aria-label="Permalink to &quot;å¼€å‘å·¥å…·&quot;">â€‹</a></h2><h3 id="æ¨èæ’ä»¶-å·¥å…·" tabindex="-1">æ¨èæ’ä»¶/å·¥å…· <a class="header-anchor" href="#æ¨èæ’ä»¶-å·¥å…·" aria-label="Permalink to &quot;æ¨èæ’ä»¶/å·¥å…·&quot;">â€‹</a></h3><ul><li><strong>Drizzle Studio</strong> - å¯è§†åŒ–æ•°æ®åº“ç®¡ç†å·¥å…·</li><li><strong>Hoppscotch/Postman</strong> - API æµ‹è¯•å·¥å…·</li><li><strong>ESLint + Prettier</strong> - ä»£ç æ ¼å¼åŒ–</li><li><strong>Bun VSCode Extension</strong> - Bun è¯­æ³•æ”¯æŒ</li></ul><h2 id="ä¸å…¶ä»–åç«¯å¯¹æ¯”" tabindex="-1">ä¸å…¶ä»–åç«¯å¯¹æ¯” <a class="header-anchor" href="#ä¸å…¶ä»–åç«¯å¯¹æ¯”" aria-label="Permalink to &quot;ä¸å…¶ä»–åç«¯å¯¹æ¯”&quot;">â€‹</a></h2><table tabindex="0"><thead><tr><th>ç‰¹æ€§</th><th>Bun + Hono</th><th>NestJS</th><th>FastAPI</th><th>Spring Boot</th></tr></thead><tbody><tr><td>è¯­è¨€</td><td>TypeScript</td><td>TypeScript</td><td>Python</td><td>Java</td></tr><tr><td>ORM</td><td>Drizzle</td><td>Prisma</td><td>SQLAlchemy</td><td>JPA</td></tr><tr><td>æ€§èƒ½</td><td>â­â­â­â­â­</td><td>â­â­â­â­</td><td>â­â­â­â­</td><td>â­â­â­</td></tr><tr><td>å­¦ä¹ æ›²çº¿</td><td>â­â­â­â­</td><td>â­â­â­</td><td>â­â­â­â­</td><td>â­â­</td></tr></tbody></table><h2 id="ç›¸å…³é“¾æ¥" tabindex="-1">ç›¸å…³é“¾æ¥ <a class="header-anchor" href="#ç›¸å…³é“¾æ¥" aria-label="Permalink to &quot;ç›¸å…³é“¾æ¥&quot;">â€‹</a></h2><ul><li><a href="https://halolight-api-bun.h7ml.cn/docs" target="_blank" rel="noreferrer">API æ–‡æ¡£</a></li><li><a href="https://github.com/halolight/halolight-api-bun" target="_blank" rel="noreferrer">GitHub ä»“åº“</a></li><li><a href="https://bun.sh/docs" target="_blank" rel="noreferrer">Bun å®˜æ–¹æ–‡æ¡£</a></li><li><a href="https://hono.dev/docs" target="_blank" rel="noreferrer">Hono å®˜æ–¹æ–‡æ¡£</a></li><li><a href="https://orm.drizzle.team/docs/overview" target="_blank" rel="noreferrer">Drizzle ORM æ–‡æ¡£</a></li><li><a href="https://docs.halolight.h7ml.cn" target="_blank" rel="noreferrer">HaloLight æ–‡æ¡£</a></li></ul>`,97)])])}const b=a(e,[["render",l]]);export{o as __pageData,b as default};
